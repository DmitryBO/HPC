# Лабораторная работа 4
## Двусторонний фильтр
**Задача**: Учитывая изображение размером MxN, реализовать и применить CUDA-версию 9-точечного двустороннего фильтра и сохранить результат в выходном изображении. Реализация должна использовать текстурную память.<br/>
**Язык**: Python 3.9.7 с использованием библиотек Numpy, Pycuda, OpenCV<br/>
**Входные данные**: Чёрно-белое изображение BMP формата, сигма-значение<br/>
**Выходные данные**: Время выполнения программы на CPU и GPU, а также изображения после обработки<br/>
### Для реализации данной задачи использовалась следующее техническое обеспечение:<br>
**CPU**: AMD Ryzen 5 2600 @ 3,4 GHz<br/>
**GPU**: NVIDIA GeForce GTX 1050 Ti<br/>
**RAM**: AMD Radeon R9 DDR4 2x8 GB<br/>
### Описание<br>
В данной лабораторной работе невозможно было использовать библиотеку Numba, поскольку она не поддерживает текстурную память. Также ради эксперимента, помимо написанных функций обработки изображений на CPU и GPU, был использован встроенный в библиотеку OpenCV двусторонний фильтр. Файл kernel.cu содержит в себе функцию, выполняемую на ядре.
### Таблица результатов работы<br>
|        Время обработки изображения на GPU |            0.41199707984924316 |
:----|:----
|        Время обработки изображения на CPU |            176.5667769908905 |
|        Время обработки изображения на CPU с помощью cv2.bilateralFilter |            0.0039997100830078125  |

### Полученные изображения <br/>
Исходное изображение<br>
![Изображение](https://github.com/DmitryBO/HPC/blob/main/images/test.bmp)
Результат работы на CPU<br>
![Изображение на CPU](https://github.com/DmitryBO/HPC/blob/main/images/res_cpu.bmp)
Результат работы на CPU с помощью OpenCV<br>
![Изображение на CPU OpenCV](https://github.com/DmitryBO/HPC/blob/main/images/res_cpu_cv2.bmp)
Результат работы на GPU<br>
![Изображение на GPU](https://github.com/DmitryBO/HPC/blob/main/images/res_gpu.bmp)


### Вывод <br/>
В результате работы, функция реализованная на GPU намного превосходит функцию на CPU в разы, однако всё равно уступает встроенному методу ```cv2.bilateralFilter``` из библиотеки OpenCV.

